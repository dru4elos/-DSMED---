## Задача 
## «Проектное исследование на основе открытых данных в области биомедицины»
## Обзор литературы
Искусственный интеллект (AI) эффективно внедряется в различные системы для классификации заболеваний на основе симптомов, сообщаемых пациентами. Эти инструменты на основе AI анализируют введенные симптомы, чтобы предложить потенциальные диагнозы, помогая как медицинским работникам, так и пациентам в понимании возможных состояний здоровья. 
Есть как общедоступные приложения, так и профессиональное программное обеспечение для использования в клиниках, как правило, на платной основе. 
#### Примеры существующих систем AI диагностики заболеваний на основе симптомов 
1) Docus AI Symptom Checker (https://docus.ai/symptom-checker )
Функциональность: использует AI, обученный на обширных медицинских данных, для оценки введенных пользователем симптомов, предоставляя список потенциальных состояний здоровья. 
Функции: предлагает удобный интерфейс, направляя пользователей через ввод симптомов и предоставляя информацию для информирования обсуждений с поставщиками медицинских услуг. 
Доступ: доступен онлайн бесплатно, направлен на помощь пользователям в понимании их симптомов и возможных причин.
2) Buoy Health's Symptom Checker (https://www.buoyhealth.com/symptom-checker/ )
Функциональность: использует передовые алгоритмы искусственного интеллекта для интерпретации симптомов, вводимых пользователями, предлагая предварительные диагнозы и рекомендации по соответствующему лечению. 
Функции: основанный на обширных данных медицинских исследований, ресурс предоставляет полный опыт, помогая пользователям эффективно решать проблемы со здоровьем. 
Доступ: доступен онлайн, разработан для помощи пользователям в принятии обоснованных решений об обращении за медицинской помощью.
3) Merative, ранее известная как IBM Watson Health (https://www.merative.com/ ), — американская компания, занимающаяся технологиями в сфере здравоохранения, специализирующаяся на анализе данных и технологических решениях для сферы здравоохранения. 
Программное обеспечение Merative предоставляет набор продуктов и услуг, направленных на улучшение процесса принятия решений и производительности в различных секторах сферы здравоохранения: 
поддержка принятия клинических решений; 
инструменты, анализирующие данные о состоянии здоровья для улучшения результатов и операционной эффективности; 
корпоративная визуализация: технологии для управления и анализа медицинских изображений 
#### Заключение по обзору литературы
Таким образом, в настоящее время появляются инструменты в виде работающих моделей машинного обучения для диагностики заболеваний или определения отдельных состояний здоровья как для врачей, так и для пациентов. Задача определения всех возможных заболеваний и состояний с применением искусственного интеллекта далека от реализации, однако мировой тренд на достижение цели запущен. 

## Цель работы
Предсказание наличия или отсутствия одного из 42 заболеваний на основе анализа 132 симптомов с применением методов машинного обучения. Набор данных состоит двух датасетов: набор для обучения **training.csv** и набор для тестирования модели **testing.csv**.

## Описание данных:
Каждый файл CSV содержит 133 столбца, из которых 132 — это симптомы различных заболеваний, а последний столбец — прогноз заболевания (представлена 41 нозология). 

Проблема классификации данных с наличием нескольких классов может решаться путем предварительной обработки данных (укрупнения классов, например). Если это невозможно из-за характера данных, тогда применяются модели машинного обучения с расширениями для обработки мультитаргетов (skilearn.multiclass) или модели, способные обрабатывать мультитаргеты напрямую(XGBClassifaier).

Необходимо обучить модели на обучающих данных с учетом наличия мультитаргета и протестировать на тестовых данных.
## Используемые Библиотеки
1) pandas
2) numpy
3) matplotlib
4) seaborn
## Библиотеки для машинного обучения
1) sklearn
2) xgboost
3) SVM
4) sklearn.multiclass - OneVsRestClassifier
## Бибиотеки для глубокой нейронной сети
1) tensorflow
## Файлы, загруженные в репозиторий

1) DSMED_Final_ASemenov.ipynb - финальный ноутбук ipynb с кодом анализа данных с проверкой трех моделей машинного обучения: SVM, Catboost, XGBoost
2) ICD_prognosis.csv – датасет с классификацией заболеваний по МКБ-10 для мультиклассовой мультилейбл-классификации. Использовался для присовения лейблов с объединениям отдельных нозологий для определения группы заболевания по МКБ-10.
3) NeuralNetworkMULTICLASS.ipynb – ноутбук ipynb с кодом построения модели нейронной сети для задачи мультиклассовой классификации.
4) Testing.csv – набор данных с симптомами и заболеваниями – использовался для валидации моделей и определения их финальных метрик.
5) Training.csv - набор данных с симптомами и заболеваниями – использовался для обучения моделей и их тестирования.
6) hackaton_DSMED_1.ipynb – ноутбук ipynb с промежуточным результатом.
7) hackaton_oka_v3 (2).ipynb – ноутбук ipynb с промежуточным результатом.
8) ovr_classifier.pkl - инференс модели машинного обучения с наилучшими результатами на тестовой выборке.
9) prognosis_ICD_ru.docx – пояснительный документ – международная классификация болезней МКБ-10. 

## Результаты и выводы


### Модель SVM (support vector machine) с использованием дизайна классификатора One-vs-Rest для работы с мультиклассом.
Accuracy, Precision, Recall и F1-score все равны 1.0 (100%), что означает, что каждый тестовый экземпляр был правильно классифицирован. Confusion Matrix не подтверждает никаких ошибочных классификаций.
Модель машинного обучения SVM работает отлично на тестовом наборе данных. Стратегия One-vs-Rest с SVM эффективна при обучении при наличии мультиклассовой целевой переменной. 


### Модель CBC (CatBoostClassifier).
Модель машинного обучения CBC показала метрики немного ниже, чем модель SVM: Accuracy: 97.6%, Precision: 98.8%, Recall: 97.6%, F1-score: 97.6%. 
Тем не менее, небольшое падение метрик CBC может означать, что данная модель может лучше генерализоваться для немного отличающихся наборов данных по сравнению с SVM c One-vs-RestClassifier.


### Модель XGB (XGBoostClassifier).
Модель машинного обучения XGBoostClassifier показала те же метрики, что и модель CBC.


### Глубокое обучение для мультклассовой классификации.
Для прогнозирования 42 заболеваний по 131 бинарному признаку использовалась архитектура нейросети из класса Visual Transformer.
Из базовой архитектуры ViT были исключёны блоки отвечающие за разбиение изображений на патчи и енкодирования эмбедингов положения патчей в изображении.
Из гиперпараметров были заданы следующие значения:
Количество слоёв: 2
Количество голов само-внимания: 8
Количество ключей внимания для голов: 64
Количество обнуляемых нейронов для устранения переобучения: 40%
Точность модели глубокого обучения на тестовом датасете составила 98%.
Модель несколько хуже предсказывает заболевания по сравнению с SVM, однако превосходит по результатам модели CatBoost и XGBoost

## Заключение
Модель SVM classifier с вариантом мультиклассовой классификации OneVsRest Classifier сработала лучше всего для предсказания разных заболеваний по симптомам. Модель выбрана в качестве основной для инференса, создан файл pkl с моделью. 
Файл доступен под номером 8 в основной директории данного проекта.

## Перспективы
Учитывая малый объём тестовой выборки, большое количество дублирующихся данных в тренировочном датасете, необходимо исследование эффективности модели предсказания в клинической практике: необходимо проведение клинического исследования эффективности прогностической модели в амбулаторном звене. Необходимо каждый из симптомов внести в отдельное окно ввода в системе ЕМИАС, после чего наладить перевод данных в табличный формат из системы, встроить модель машинного обучения в систему, чтобы при заполнении всех ячеек появлялось предсказание заболевания в виде доли его вероятности. После чего оценить длительность приема врача, долю совпадения диагноза с инструментальными методами обследования - рассчитать эффективность внедрения модели.
